@---------------------------------------------------------------------------------
.section .text,"ax"
@---------------------------------------------------------------------------------
	#include "equates.h"
	#include "6502mac.h"
@---------------------------------------------------------------------------------	
	.global mapper0init
	.global mapper2init
	.global mapper3init
	.global mapper7init
	.global mapper71init
	.global mapper180init
/*
@---------------------------------------------------------------------------------
mapper0init:
@---------------------------------------------------------------------------------
	.word void,void,void,void
	bx lr*/
@---------------------------------------------------------------------------------
mapper2init:
@---------------------------------------------------------------------------------
	.word map89AB_,map89AB_,map89AB_,map89AB_
	bx lr
@---------------------------------------------------------------------------------
mapper3init:
@---------------------------------------------------------------------------------
	.word chr01234567_,chr01234567_,chr01234567_,chr01234567_
	bx lr
@---------------------------------------------------------------------------------
mapper7init:
@---------------------------------------------------------------------------------
	.word write0,write0,write0,write0
	bx lr
@---------------------------------------------------------------------------------
mapper71init:
@---------------------------------------------------------------------------------
	.word map71w,void,map89AB_,map89AB_
	adr r0, map71wl
	str_ r0, writemem_tbl+12
	
	ldr_ r0, prgcrc
	ldr r1, =0x11CF
	cmp r0, r1
	ldrne r1, =0x9F84
	cmpne r0, r1
	movne pc, lr

	adr r0,m71irqhook
	str_ r0,scanlinehook

	adr r1,m71iow
	str_ r1,writemem_tbl+8

	bx lr
@---------------------------------------------------------------------------------
mapper180init:
@---------------------------------------------------------------------------------
	.word mapCDEF_,mapCDEF_,mapCDEF_,mapCDEF_
	bx lr
@---------------------------------------------------------------------------------
map71w:
	tst addy,#0x1000
	moveq pc,lr
	tst r0,#0x10
	b mirror1_
@-------------------------------------
@patch for bignose freak out..
m71irqhook:
	ldr_ r0, scanline
	cmp r0, #179
	bne hk0

	ldr r0, irq_pend
	ands r0, r0, r0
	beq hk0

	mov r0, #0
	str r0, irq_pend
	b CheckI
hk0:
	fetch 0
m71iow:
	and r2, addy, #0xff
	cmp r2, #0x15
	bne IO_W

	tst r0, #16
	strne r0, irq_pend
	bic r0, #16
	b IO_W

irq_pend:
	.word 0
@---------------------------------------
@---------------------------------------------------------------------------------
write0:
@---------------------------------------------------------------------------------
	stmfd sp!,{r0,lr}
	tst r0,#0x10
	bl mirror1_
	ldmfd sp!,{r0,lr}
	b map89ABCDEF_
@---------------------------------------------------------------------------------
map71wl:
	and r1, addy, #0xE000
	cmp r1, #0x6000
	movne pc, lr
	b map89AB_